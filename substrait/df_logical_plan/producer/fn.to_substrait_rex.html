<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Convert DataFusion Expr to Substrait Rex"><title>to_substrait_rex in substrait::df_logical_plan::producer - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../../static.files/rustdoc-46132b98.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="substrait" data-themes="" data-resource-suffix="" data-rustdoc-version="1.85.0-nightly (409998c4e 2024-12-24)" data-channel="nightly" data-search-js="search-036cda7a.js" data-settings-js="settings-0f613d39.js" ><script src="../../../static.files/storage-59e33391.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-044be391.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../substrait/index.html">substrait</a><span class="version">0.12.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">to_<wbr>substrait_<wbr>rex</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#arguments" title="Arguments">Arguments</a></li></ul></section><div id="rustdoc-modnav"><h2><a href="index.html">In substrait::<wbr>df_<wbr>logical_<wbr>plan::<wbr>producer</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../../index.html">substrait</a>::<wbr><a href="../index.html">df_logical_plan</a>::<wbr><a href="index.html">producer</a></span><h1>Function <span class="fn">to_substrait_rex</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"></span></div><pre class="rust item-decl"><code>pub fn to_substrait_rex(
    state: &amp;dyn <a class="trait" href="../state/trait.SubstraitPlanningState.html" title="trait substrait::df_logical_plan::state::SubstraitPlanningState">SubstraitPlanningState</a>,
    expr: &amp;Expr,
    schema: &amp;<a class="struct" href="https://doc.rust-lang.org/nightly/alloc/sync/struct.Arc.html" title="struct alloc::sync::Arc">Arc</a>&lt;DFSchema&gt;,
    col_ref_offset: <a class="primitive" href="https://doc.rust-lang.org/nightly/std/primitive.usize.html">usize</a>,
    extensions: &amp;mut Extensions,
) -&gt; <a class="enum" href="https://doc.rust-lang.org/nightly/core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;Expression, DataFusionError&gt;</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Convert DataFusion Expr to Substrait Rex</p>
<h2 id="arguments"><a class="doc-anchor" href="#arguments">§</a>Arguments</h2>
<ul>
<li><code>expr</code> - DataFusion expression to be parse into a Substrait expression</li>
<li><code>schema</code> - DataFusion input schema for looking up field qualifiers</li>
<li><code>col_ref_offset</code> - Offset for calculating Substrait field reference indices.
This should only be set by caller with more than one input relations i.e. Join.
Substrait expects one set of indices when joining two relations.
Let’s say <code>left</code> and <code>right</code> have <code>m</code> and <code>n</code> columns, respectively. The <code>right</code>
relation will have column indices from <code>0</code> to <code>n-1</code>, however, Substrait will expect
the <code>right</code> indices to be offset by the <code>left</code>. This means Substrait will expect to
evaluate the join condition expression on indices [0 .. n-1, n .. n+m-1]. For example:
<code>SELECT *                      FROM t1                      JOIN t2                      ON t1.c1 = t2.c0;</code>
where t1 consists of columns [c0, c1, c2], and t2 = columns [c0, c1]
the join condition should become
<code>col_ref(1) = col_ref(3 + 0)</code>
, where <code>3</code> is the number of <code>left</code> columns (<code>col_ref_offset</code>) and <code>0</code> is the index
of the join key column from <code>right</code></li>
<li><code>extensions</code> - Substrait extension info. Contains registered function information</li>
</ul>
</div></details></section></div></main></body></html>